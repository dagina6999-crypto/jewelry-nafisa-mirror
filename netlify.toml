[build]
  command = """
    # 1. Clean up previous Flutter SDK directory
    rm -rf flutter && \
    # 2. Clone the Flutter SDK
    git clone https://github.com/flutter/flutter.git && \
    # 3. Enable web support
    ./flutter/bin/flutter config --enable-web && \
    # 4. Create the .env file from Netlify's variables
    echo "SUPABASE_URL=${SUPABASE_URL}" >> .env && \
    echo "SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}" >> .env && \
    echo "GOOGLE_SIGN_IN_WEB_CLIENT_ID=${GOOGLE_SIGN_IN_WEB_CLIENT_ID}" >> .env && \
    # 5. Run the actual build
    ./flutter/bin/flutter build web --release
  """
  publish = "build/web"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200